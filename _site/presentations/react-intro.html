<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Rosengren.me - Intro to React</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content=" I'm one of those guys that code thingamajigs, sometimes for mobile devices, but mostly for the web using Javascript and css/less. ">

        <meta property="og:type" content="website"/>
        <meta property="og:image" content="http://www.rosengren.me/assets/images/badge.jpg" />
        <meta property="og:description" content=" I'm one of those guys that code thingamajigs, sometimes for mobile devices, but mostly for the web using Javascript and css/less. "/>

        <!--[if lt IE 9]>
           <script>
              document.createElement('nav');
              document.createElement('header');
              document.createElement('section');
              document.createElement('footer');
              document.createElement('article');
              document.createElement('time');
           </script>
        <![endif]-->
        <link rel="stylesheet" href="/assets/styles/rosengren.css">

    </head>
    <body>
      <div class="navbar-menu-toggle" id="menu-toggle">Menu</div>
      <div class="page" id="page">
        <nav class="navbar" id="navbar-menu">
          <div class="navbar-menu collapse">
            <a class="navbar-menu-item navbar-menu-title navbar-menu-item--home" href="/">home</a>
            <a class="navbar-menu-item navbar-menu-item--blog" href="/blog">blog</a>
          </div>
          <span class="navbar-menu navbar-menu-contact collapse">
            <a class="navbar-menu-item navbar-menu-item--linkedin" href="http://www.linkedin.com/in/srosengren" target="_blank">LinkedIn</a>
            <a class="navbar-menu-item navbar-menu-item--twitter" href="https://twitter.com/srrosengren" target="_blank">Twitter</a>
            <a class="navbar-menu-item navbar-menu-item--github" href="https://github.com/srosengren" target="_blank">Github</a>
            <a class="navbar-menu-item navbar-menu-item--mail" href="javascript:;" id="mail-link">Mail</a>
          </span>
        </nav>
        <div class="main-content" id="content">
            <h2 id="what-why">what? Why?</h2>
<ul>
  <li>A viewengine</li>
  <li>Not a framework, coexists with others</li>
  <li>Render on every change</li>
  <li>Templates? We’ve got javascript</li>
  <li>Components</li>
  <li>Virtual DOM</li>
  <li>Lightweight description, not actual DOM</li>
  <li>Easy isomorphism</li>
  <li>Lear once, use everywhere</li>
</ul>

<p>React wraps an imperative API with a declarative one.</p>

<h2 id="jsx">JSX</h2>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">ProfileImage</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span> <span class="o">/&gt;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">Bio</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
      <span class="o">&lt;</span><span class="nx">ProfileImage</span> <span class="nx">url</span><span class="o">=</span><span class="s2">&quot;urlToImage&quot;</span> <span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="err">/div&gt;</span>
  <span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<p>Is transpiled into</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">ProfileImage</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">,{</span><span class="nx">src</span><span class="o">:</span> <span class="nx">props</span><span class="p">.</span><span class="nx">url</span><span class="p">})</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">Bio</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span>
    <span class="s1">&#39;div&#39;</span><span class="p">,</span>
    <span class="kc">null</span><span class="p">,</span>
    <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span>
      <span class="s1">&#39;h2&#39;</span><span class="p">,</span>
      <span class="kc">null</span><span class="p">,</span>
      <span class="nx">props</span><span class="p">.</span><span class="nx">title</span>
    <span class="p">),</span>
    <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span>
      <span class="nx">ProfileImage</span><span class="p">,</span>
      <span class="p">{</span><span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;urlToImage&quot;</span><span class="p">}</span>
    <span class="p">)</span>
  <span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h2 id="components">Components</h2>

<h3 id="stateful">Stateful</h3>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">MyComponent</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">getInitialState</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">{</span><span class="nx">number</span><span class="o">:</span> <span class="mi">0</span><span class="p">};</span>
  <span class="p">},</span>
  <span class="nx">increment</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">number</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">});</span>
  <span class="p">}</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">increment</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
      <span class="o">&lt;</span><span class="err">/div&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">})</span>

<span class="kr">class</span> <span class="nx">MyComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
    <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span><span class="nx">number</span><span class="o">:</span> <span class="mi">0</span><span class="p">};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">increment</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">increment</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">number</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">});</span>
  <span class="p">}</span>
  <span class="nx">render</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">increment</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
      <span class="o">&lt;</span><span class="err">/div&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<ul>
  <li>Has a backing instance (this)</li>
  <li>Lifecycle methods</li>
  <li>Access to this.state</li>
</ul>

<h3 id="stateless">Stateless</h3>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">MyComponent</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">increment</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">number</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
    <span class="o">&lt;</span><span class="err">/div&gt;</span>
  <span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<ul>
  <li>Pure function (No side effects)</li>
  <li>Gets props as as an argument</li>
  <li>Faster path to render</li>
</ul>

<h2 id="render-into-dom">Render into DOM</h2>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;MountNode&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">MainComponent</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Hello</span> <span class="nx">world</span><span class="o">!&lt;</span><span class="err">/h1&gt;</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
  <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">MainComponent</span><span class="p">),</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;MountNode&#39;</span><span class="p">)</span>  
<span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;MountNode&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h1&gt;</span>Hello World!<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<p>Common: Top level component, single entry
Also: augment existing app with sprinkles of React.</p>

<h3 id="if-statements">If statements</h3>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">ProfileImage</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">isIcon</span><span class="p">)</span>
        <span class="o">&lt;</span><span class="nx">i</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&quot;icon&quot;</span><span class="o">&gt;&lt;</span><span class="err">/i&gt;</span>
      <span class="k">else</span>
        <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span> <span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="err">/div&gt;</span>
  <span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<p>Not legal javascript</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">ProfileImage</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span>
    <span class="s1">&#39;div&#39;</span><span class="p">,</span>
    <span class="kc">null</span><span class="p">,</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">isIcon</span><span class="p">)</span>
      <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span>
        <span class="s1">&#39;i&#39;</span><span class="p">,</span>
        <span class="p">{</span><span class="nx">className</span><span class="o">:</span> <span class="s1">&#39;icon&#39;</span><span class="p">}</span>
      <span class="p">)</span>
    <span class="k">else</span>
      <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span>
        <span class="s1">&#39;img&#39;</span><span class="p">,</span>
        <span class="p">{</span><span class="nx">url</span><span class="o">:</span> <span class="nx">props</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span>
      <span class="p">)</span>
  <span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">ProfileImage</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
      <span class="p">{</span> <span class="nx">props</span><span class="p">.</span><span class="nx">isIcon</span> <span class="o">?</span>
        <span class="o">&lt;</span><span class="nx">i</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&quot;icon&quot;</span><span class="o">&gt;&lt;</span><span class="err">/i&gt;</span>
      <span class="o">:</span>
        <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span> <span class="o">/&gt;</span>
      <span class="p">}</span>
    <span class="o">&lt;</span><span class="err">/div&gt;</span>
  <span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<p>Totally legit</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">ProfileImage</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span>
    <span class="s1">&#39;div&#39;</span><span class="p">,</span>
    <span class="kc">null</span><span class="p">,</span>
    <span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">isIcon</span> <span class="o">?</span>
      <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span>
        <span class="s1">&#39;i&#39;</span><span class="p">,</span>
        <span class="p">{</span><span class="nx">className</span><span class="o">:</span> <span class="s1">&#39;icon&#39;</span><span class="p">}</span>
      <span class="p">)</span>
      <span class="o">:</span>
      <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span>
        <span class="s1">&#39;img&#39;</span><span class="p">,</span>
        <span class="p">{</span><span class="nx">url</span><span class="o">:</span> <span class="nx">props</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span>
      <span class="p">))</span>
  <span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="loopslists">Loops/lists</h3>

<p>Same as if statments, can’t have a for loop in function call</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">Menu</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
      <span class="nx">props</span><span class="p">.</span><span class="nx">menuItems</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">){</span>
        <span class="o">&lt;</span><span class="nx">MenuItem</span> <span class="nx">item</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">}</span> <span class="o">/&gt;</span>
      <span class="p">})</span>
    <span class="o">&lt;</span><span class="err">/ul&gt;</span>
  <span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h2 id="composition">Composition</h2>

<ul>
  <li>Common pattern to have a stateful component composed with stateless children (controller view)</li>
  <li>Children has no knowledge of parent</li>
  <li>Communicates “up” with callbacks or actions.</li>
</ul>

<h3 id="state-vs-props">State vs props</h3>

<ul>
  <li>State is a side effect</li>
  <li>Pure functions</li>
  <li>Single source of truth</li>
  <li>Which ancestor has changed?</li>
  <li>Don’t convert props to state, changes ownership, becomes stale.</li>
</ul>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">//NO! Bad developer!</span>
<span class="kd">var</span> <span class="nx">ItsMine</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createCLass</span><span class="p">({</span>
  <span class="nx">getInitialState</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">theOneRing</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">theOneRing</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">theOneRing</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">//Better</span>
<span class="kd">var</span> <span class="nx">MaybeILook</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createCLass</span><span class="p">({</span>
  <span class="nx">getOwnRing</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ring</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">myRing</span><span class="o">:</span> <span class="nx">ring</span><span class="p">});</span>
  <span class="p">},</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">myRing</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">theOneRing</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">//Often best</span>
<span class="kd">var</span> <span class="nx">DisplayPrettyRing</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">theOneRing</span><span class="p">}</span><span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span>
<span class="p">}</span></code></pre></figure>

<h3 id="controller-view">Controller view</h3>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">Menu</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">selectItem</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">itemId</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">selectedItemId</span><span class="o">:</span> <span class="nx">itemId</span><span class="p">});</span>
  <span class="p">},</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">MenuItem</span> <span class="nx">select</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">selectItem</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="mi">1</span><span class="p">)}</span> <span class="nx">isSelected</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">selectedItemId</span> <span class="o">===</span> <span class="mi">1</span><span class="p">}</span><span class="o">&gt;</span>
          <span class="nx">Item1</span>
        <span class="o">&lt;</span><span class="err">/MenuItem&gt;</span>
        <span class="o">&lt;</span><span class="nx">MenuItem</span> <span class="nx">select</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">selectItem</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="mi">2</span><span class="p">)}</span> <span class="nx">isSelected</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">selectedItemId</span> <span class="o">===</span> <span class="mi">2</span><span class="p">}</span><span class="o">&gt;</span>
          <span class="nx">Item2</span>
        <span class="o">&lt;</span><span class="err">/MenuItem&gt;</span>
        <span class="o">&lt;</span><span class="nx">MenuItem</span> <span class="nx">select</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">selectItem</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="mi">3</span><span class="p">)}</span> <span class="nx">isSelected</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">selectedItemId</span> <span class="o">===</span> <span class="mi">3</span><span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">h4</span><span class="o">&gt;</span><span class="nx">Complex</span> <span class="nx">child</span><span class="o">&lt;</span><span class="err">/h4&gt;</span>
          <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Desc</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
        <span class="o">&lt;</span><span class="err">/MenuItem&gt;</span>
      <span class="o">&lt;</span><span class="err">/div&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">})</span>

<span class="kd">var</span> <span class="nx">MenuItem</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">onClick</span><span class="o">&gt;</span>
      <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">}</span>
    <span class="o">&lt;</span><span class="err">/div&gt;</span>
  <span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h3 id="mixins">Mixins</h3>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">StoreMixin</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">componentWillMount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">unsubscribe</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">storeChanged</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">componentWillUnmount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">unsubscribe</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">StoreListener</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">mixins</span><span class="o">:</span> <span class="p">[</span><span class="nx">StoreMixin</span><span class="p">],</span>
  <span class="nx">store</span><span class="o">:</span> <span class="nx">MyStore</span><span class="p">,</span>
  <span class="nx">storeChanged</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">data</span><span class="o">:</span> <span class="nx">MyStore</span><span class="p">.</span><span class="nx">get</span><span class="p">()});</span>
  <span class="p">},</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">data</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/div&gt;</span>
  <span class="p">}</span>
<span class="p">});</span></code></pre></figure>

<ul>
  <li>Provides lifecycle hooks</li>
  <li>Magic merge of lifecycle hooks</li>
  <li>Might use the same state field</li>
  <li>Crashes if mixins define the same props/functions</li>
  <li>Not available on es6 classes</li>
</ul>

<h3 id="higher-order-components">Higher order components</h3>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">StoreHO</span> <span class="o">=</span> <span class="p">(</span><span class="nx">Component</span><span class="p">,</span><span class="nx">store</span><span class="p">,</span><span class="nx">mapping</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
    <span class="nx">componentWillMount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">unsubscribe</span> <span class="o">=</span> <span class="nx">store</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">storeUpdate</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">componentWillUnmount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">unsubscribe</span><span class="p">();</span>
    <span class="p">},</span>
    <span class="nx">storeUpdate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="nx">mapping</span><span class="p">(</span><span class="nx">store</span><span class="p">.</span><span class="nx">get</span><span class="p">()));</span>
    <span class="p">},</span>
    <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
      <span class="k">return</span> <span class="o">&lt;</span><span class="nx">Component</span> <span class="p">{...</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">}</span> <span class="p">{...</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">}</span> <span class="o">/&gt;</span>
    <span class="p">}</span>
  <span class="p">})</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">StoreListener</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">data</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/div&gt;</span>
<span class="p">}</span>

<span class="nx">StoreListener</span> <span class="o">=</span> <span class="nx">StoreHO</span><span class="p">(</span><span class="nx">StoreListener</span><span class="p">,</span><span class="nx">MyStore</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">storeData</span><span class="p">){</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">data</span><span class="o">:</span> <span class="nx">storeData</span>
  <span class="p">}</span>
<span class="p">});</span></code></pre></figure>

<ul>
  <li>Has its own backing instance (this) with own state</li>
  <li>Infinitely chainable/nestable</li>
  <li>Only collision risk is props being overwritten</li>
  <li>Can wrap stateless components</li>
  <li>Transparent</li>
</ul>

<h3 id="wrapper-components">Wrapper components</h3>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">StoreWrapper</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">componentWillMount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">unsubscribe</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">storeUpdate</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">componentWillUnmount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">unsubscribe</span><span class="p">();</span>
  <span class="p">},</span>
  <span class="nx">storeUpdate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="nx">mapping</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">get</span><span class="p">()));</span>
  <span class="p">},</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Children</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">child</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">React</span><span class="p">.</span><span class="nx">cloneElement</span><span class="p">(</span><span class="nx">child</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">StoreConsumer</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">data</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/div&gt;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">Application</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">StoreWrapper</span> <span class="nx">store</span><span class="o">=</span><span class="p">{</span><span class="nx">MyStore</span><span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">StoreConsumer</span> <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="err">/StoreWrapper&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">});</span></code></pre></figure>

<ul>
  <li>Mostly used to provide layout wrapping</li>
  <li>Easy to provide separate props for wrapper/child</li>
  <li>Can wrap stateless components</li>
  <li>Hidden coupling</li>
  <li>Has to provide layout</li>
  <li>Opaque</li>
</ul>

<h1 id="flux">Flux</h1>

<h2 id="types-of-flux">Types of flux</h2>

<h3 id="flux-with-dispatcher-flux-utils">Flux with dispatcher, Flux utils</h3>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">appDispatcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Flux</span><span class="p">.</span><span class="nx">Dispatcher</span><span class="p">();</span>

<span class="kr">class</span> <span class="nx">Store</span> <span class="kr">extends</span> <span class="nx">PseudoStore</span> <span class="p">{</span>
  <span class="nx">number</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="nx">unregisterToken</span><span class="o">:</span> <span class="nx">appDispatcher</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">action</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;ACTION_INCREMENT&#39;</span><span class="p">){</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">number</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">emitChange</span><span class="p">();</span>
  <span class="p">});</span>  
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">NumberComponent</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">getInitialState</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">storeData</span><span class="o">:</span> <span class="nx">Store</span><span class="p">.</span><span class="nx">get</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">componentWillMount</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">unregisterStore</span> <span class="o">=</span> <span class="nx">Store</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">onStoreChange</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">componentWillUnmount</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">unRegisterStore</span><span class="p">();</span>
  <span class="p">},</span>
  <span class="nx">onStoreChange</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
      <span class="nx">storeData</span><span class="o">:</span> <span class="nx">Store</span><span class="p">.</span><span class="nx">get</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">},</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">storeDate</span><span class="o">&lt;</span><span class="err">/div&gt;;</span>
  <span class="p">}</span>
<span class="p">});</span></code></pre></figure>

<ul>
  <li>Very verbose</li>
  <li>Magical strings</li>
</ul>

<h3 id="flux-without-dispatcher-reflux">Flux without dispatcher, Reflux</h3>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">incrementAction</span> <span class="o">=</span> <span class="nx">Reflux</span><span class="p">.</span><span class="nx">createAction</span><span class="p">(</span><span class="s1">&#39;increment&#39;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">Store</span> <span class="o">=</span> <span class="nx">Reflux</span><span class="p">.</span><span class="nx">createStore</span><span class="p">({</span>
  <span class="nx">number</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">listenTo</span><span class="p">(</span><span class="nx">incrementAction</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">increment</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">increment</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">number</span><span class="o">++</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">number</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">NumberComponent</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">getInitialState</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">{};</span>
  <span class="p">},</span>
  <span class="nx">mixins</span><span class="o">:</span> <span class="p">[</span><span class="nx">Reflux</span><span class="p">.</span><span class="nx">listenTo</span><span class="p">(</span><span class="nx">Store</span><span class="p">,</span><span class="s1">&#39;onStoreChange&#39;</span><span class="p">)],</span>
  <span class="nx">onStoreChange</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">storeState</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
      <span class="nx">storeData</span><span class="o">:</span> <span class="nx">storeState</span>
    <span class="p">});</span>
  <span class="p">},</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">storeDate</span><span class="o">&lt;</span><span class="err">/div&gt;;</span>
  <span class="p">}</span>
<span class="p">});</span></code></pre></figure>

<ul>
  <li>Every action is a dispatcher</li>
  <li>Stores can listen to individual actions</li>
</ul>

<h3 id="flux-without-flux-redux">Flux without flux, Redux</h3>

<h2 id="immutable-data">Immutable data</h2>

<ul>
  <li>Easy to see if an object has changed</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>oldObject === newObject instead of oldObject.prop1 === newObject.prop1</td>
          <td> </td>
          <td>oldObject.prop2 === …</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>Removes one source of side effects.</li>
  <li>Object.freeze, extreme immutability</li>
</ul>

        </div>
        <footer class="footer-content">
          Powered by <a href="http://http://jekyllrb.com/" target="_blank">Jekyll</a>, hosted on <a href="https://github.com/" target="_blank">Github</a>, compiled using <a href="http://www.ruby-lang.org/en/" target="_blank">Ruby</a> and <a href="http://http://python.org/" target="_blank">Python</a> by a <a href="http://www.microsoft.com/net" target="_blank">.NET</a> guy.
        </footer>
      </div>
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-41772613-1', 'rosengren.me');
        ga('send', 'pageview');

        document.getElementById('mail-link').href = 'mailto:' + 'sebastian' + '@' + 'rosengren' + '.me';

        document.getElementById('menu-toggle').addEventListener('click', function(){
          var navbar = document.getElementById('page');
          if(navbar.className.indexOf('drawer--open') > -1){
            navbar.className = navbar.className.replace(' drawer--open','');
          } else {
            navbar.className = navbar.className + ' drawer--open';
          }
        });

        document.getElementById('content').addEventListener('click',function(){
          var navbar = document.getElementById('page');
          if(navbar.className.indexOf('drawer--open') > -1){
            navbar.className = navbar.className.replace(' drawer--open','');
          }
        })
      </script>
    </body>
</html>
