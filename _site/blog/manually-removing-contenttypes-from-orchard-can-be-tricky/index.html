<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Rosengren.me - Manually removing ContentTypes from Orchard can be tricky.</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">

        <meta property="og:type" content="article"/>
        <meta property="og:image" content="http://www.rosengren.me/assets/images/badge.jpg" />
        <meta property="og:description" content="I was experimenting with a new contentpart widget tonight, and when I was done I had a couple of UpdateFromX methods in my migrations.cs file. So I thought to myself, this doesn't look very good, lets delete everything from the DB and then combine this to a pretty Create method instead. At first I thought, hey maybe I'll only have to remove the table that stores the records themselved. This was of course not enought. I realized that I also had to remove it from the Orchard_Framework_DataMigrationRecord and Orchard_Framework_ContentTypeRecord tables. I think this would be it if I hadn't been clever enough to actually create a couple of widgets and place them on the layer that displays on my homepage.

"/>

        <!--[if lt IE 9]>
           <script>
              document.createElement('nav');
              document.createElement('header');
              document.createElement('section');
              document.createElement('footer');
              document.createElement('article');
              document.createElement('time');
           </script>
        <![endif]-->

        <link rel="stylesheet" href="/assets/styles/syntax.css">
        <link href="//netdna.bootstrapcdn.com/font-awesome/3.1.1/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" href="/assets/styles/rosengren.css">

    </head>
    <body>
      <header class="site-header" id="site-header">
        <nav class="social-nav" id="site-social">
          <a href="http://www.linkedin.com/in/srosengren" target="_blank" class="icon-linkedin social-nav__item"></a>
          <a href="https://twitter.com/srrosengren" target="_blank" class="icon-twitter social-nav__item"></a>
          <a href="https://github.com/srosengren" target="_blank" class="icon-github social-nav__item"></a>
          <a href="https://plus.google.com/100467627792652344906/posts?rel=author" target="_blank" class="icon-google-plus social-nav__item"></a>
          <a href="javascript:;" id="mail-link" class="icon-envelope social-nav__item"></a>
        </nav>
        <div class="site-header__content">
          <p class="site-header__excerpt" id="site-description">Hi I'm <em>Sebastian Rosengren</em>, I'm one of those guys that code thingamajigs, sometimes for mobile devices, but mostly for the web using <em>Javascript</em> and <em>css/less</em>.</p>
          <a href="/" class="site-header__image" title="home"></a>
          <!--<nav class="site-nav">
            <a href="/" class="site-nav__item">Home</a>
            <a href="/blog" class="site-nav__item">Blog</a>
          </nav>-->
        </div>
      </header>
      <div class="container">
        <div class="container">
	<articlec class="post">
		<header>
			<h1 class="post__title">Manually removing ContentTypes from Orchard can be tricky.</h1>
			<div class="post__byline">
				<time datetime="2012-09-26 22:52:00 +0200">26 Sep 2012</time>
				orchard, contenttype, datamigration, development, and web
			</div>
		</header>
		<div class="post__content"><p>I was experimenting with a new contentpart widget tonight, and when I was done I had a couple of UpdateFromX methods in my migrations.cs file. So I thought to myself, this doesn&#8217;t look very good, lets delete everything from the DB and then combine this to a pretty Create method instead. At first I thought, hey maybe I&#8217;ll only have to remove the table that stores the records themselved. This was of course not enought. I realized that I also had to remove it from the Orchard_Framework_DataMigrationRecord and Orchard_Framework_ContentTypeRecord tables. I think this would be it if I hadn&#8217;t been clever enough to actually create a couple of widgets and place them on the layer that displays on my homepage.</p>

<p>This was of course happening while I was struggling with som multi-tenancy issues so I left this here thinking I was done and started to tackle one of my subsites. Well that site would of course not start and instead gave me this error: <strong>no row with the given identifier exists&#124;orchard.contentmanagement.records.contentitemrecord#15&#93;</strong></p>

<p>Now that I think back I realize that this error message actually makes a lot of sense. I had a contentrecord with the ContentType_id set to the removed contentype&#8217;s id (<strong>15</strong>) in my&amp;amp Orchard_Framework_ContentItemRecord table. I thought that this would be it and removed it. But there was still a final puzzlepiece missing, the Orchard_Framework_ContentItemVersionRecord that contained a row with the id of the removed record.</p>

<p>There are also a couple of tables that might have to be considered if you plan on making major changes while cleaning up your migration file and these are the Settings_* tables. They contain the settings for your record/part and are worth looking into if you are changing the settings during cleanup.</p></div>
	</article>
</div>
      </div>
      <!--<footer class="container footer-content">
        Powered by <a href="http://http://jekyllrb.com/" target="_blank">Jekyll</a>, hosted on <a href="https://github.com/" target="_blank">Github</a>, compiled using <a href="http://www.ruby-lang.org/en/" target="_blank">Ruby</a> and <a href="http://http://python.org/" target="_blank">Python</a> by a <a href="http://www.microsoft.com/net" target="_blank">.NET</a> guy.
      </footer>-->

        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-41772613-1', 'rosengren.me');
          ga('send', 'pageview');

          document.getElementById('mail-link').href = 'mailto:' + 'sebastian' + '@' + 'rosengren' + '.me';

          window.onscroll = function(e){
            var socialBar = document.getElementById('site-social'),
                siteDescription = document.getElementById('site-description'),
                siteHeader = document.getElementById('site-header');

                if(window.scrollY >= (siteHeader.clientHeight - socialBar.clientHeight)){
                  
                } else {
                }

          }
        </script>
    </body>
</html>
