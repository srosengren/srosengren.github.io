<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Rosengren.me - Change the framework for an application on IIS6</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="page.excerpt">

        <meta property="og:type" content="article"/>
        <meta property="og:image" content="http://www.rosengren.me/assets/images/badge.jpg" />
        <meta property="og:description" content="Sometimes you have to work with older software, like IIS6 on windows server 2003.

"/>

        <!--[if lt IE 9]>
           <script>
              document.createElement('nav');
              document.createElement('header');
              document.createElement('section');
              document.createElement('footer');
              document.createElement('article');
              document.createElement('time');
           </script>
        <![endif]-->

        <link rel="stylesheet" href="/assets/styles/syntax.css">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" href="/assets/styles/rosengren.css">

    </head>
    <body>
      <div class="navbar-menu-toggle" id="menu-toggle"></div>
      <nav class="navbar" id="navbar-menu">
        <div class="navbar-menu collapse">
          <a class="navbar-menu-item navbar-menu-title navbar-menu-item--home" href="/">home</a>
          <a class="navbar-menu-item navbar-menu-item--blog" href="/blog">blog</a>
        </div>
        <ul class="navbar-menu navbar-spots right collapse">
          <li class="navbar-menu-item spot">
            <div class="spot-bubble">
              <a href="http://www.linkedin.com/in/srosengren" target="_blank" class="fa fa-linkedin"></a>
            </div>
            <span class="spot-title">Linkedin</span>
          </li>
          <li class="navbar-menu-item spot">
            <div class="spot-bubble">
              <a href="https://twitter.com/srrosengren" target="_blank" class="fa fa-twitter"></a>
            </div>
            <span class="spot-title">Twitter</span>
          </li>
          <li class="navbar-menu-item spot">
            <div class="spot-bubble">
              <a href="https://github.com/srosengren" target="_blank" class="fa fa-github"></a>
            </div>
            <span class="spot-title">Github</span>
          </li>
          <li class="navbar-menu-item spot">
            <div class="spot-bubble">
              <a href="https://plus.google.com/100467627792652344906/posts?rel=author" target="_blank" class="fa fa-google-plus"></a>
            </div>
            <span class="spot-title">G+</span>
          </li>
          <li class="navbar-menu-item spot">
            <div class="spot-bubble">
              <a href="javascript:;" id="mail-link" class="fa fa-envelope"></a>
            </div>
            <span class="spot-title">Mail</span>
          </li>
        </ul>
      </nav>
      <div class="main-content" id="content">
          <div class="container">
	<article class="post">
		<header>
			<h1 class="post__title">Change the framework for an application on IIS6</h1>
			<div class="post__byline">
				<time datetime="2012-08-30 15:38:00 +0200">30 Aug 2012</time>
				web, iis, sitecore, and development
			</div>
		</header>
		<div class="post__content"><p>Sometimes you have to work with older software, like IIS6 on windows server 2003.</p>

<p>And sometimes this happen to coincide with you working on an application that requires an older framework, like Sitecore 6.1 on .NET2.0</p>

<p>I was trying to run a Sitecore 6.1 site in IIS6 on a windows server 2003 that had .NET 1.1 2.0 and 4.0 installed. The application was automatically started with .NET 4.0 which doesn&#8217;t play well with Sitecore 6.1. I then tried to change the framework to .NET 2.0 which produced the following error.</p>

<blockquote>
<p>Changing the Framework version requires a restart of the W3SVC service. Alternatively, you can change the Framework version without restarting the W3SVC service by running: aspnet_regiis.exe -norestart -s IIS-Viirtual-Path</p>
</blockquote>

<p>Well, I couldn&#8217;t let it restart w3svc since a lot of other sites ran on the same server, so I tried the alternative with a few issues.</p>

<p>The first thing I noticed was that aspnet_regiis was not in my PATH so i had to find it on the filesystem (C:\WINDOWS\microsoft.net\Framework64\v2.0.50727\aspnet_regiis.exe for the 64bit version of 2.0).</p>

<p>The next issue was to find the virtualpath for my application. I found that there&#8217;s a formula to this the path should look like this: &#8220;w3svc/appID&#8221;, you can find your appID by locating your websites identifier field in the website view of the IIS manager.</p>

<p>This was of course not enough to get the application to run. I still had to create a new application pool and change the application to use this pool instead since there can only be one version of the .NET framework per pool. You can change the application pool by opening the properties for your application and looking under the &#8220;Home Directory&#8221; tab.</p></div>
	</article>
</div>
      </div> <!-- /container -->
      <footer class="container footer-content">
        Powered by <a href="http://http://jekyllrb.com/" target="_blank">Jekyll</a>, hosted on <a href="https://github.com/" target="_blank">Github</a>, compiled using <a href="http://www.ruby-lang.org/en/" target="_blank">Ruby</a> and <a href="http://http://python.org/" target="_blank">Python</a> by a <a href="http://www.microsoft.com/net" target="_blank">.NET</a> guy.
      </footer>

        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-41772613-1', 'rosengren.me');
          ga('send', 'pageview');

          document.getElementById('mail-link').href = 'mailto:' + 'sebastian' + '@' + 'rosengren' + '.me';

          document.getElementById('menu-toggle').addEventListener('click', function(){
            var navbar = document.getElementById('navbar-menu');
            if(navbar.className.indexOf('open') > 0){
              navbar.className = navbar.className.replace(' open','');
            } else {
              navbar.className = navbar.className + ' open';
            }
          });

          document.getElementById('content').addEventListener('click',function(){
            var navbar = document.getElementById('navbar-menu');
            if(navbar.className.indexOf('open') > 0){
              navbar.className = navbar.className.replace(' open','');
            }
          })
        </script>
    </body>
</html>
