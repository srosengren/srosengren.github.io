<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Rosengren.me - Change the framework for an application on IIS6</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/">Rosengren.me</a></h1>
              <a class="extra" href="/">home</a>
            </div>

                <h2>Rosengren.me: Change the framework for an application on IIS6</h2>
<p class="meta">30 Aug 2012</p>

<div class="post">
<p>Sometimes you have to work with older software, like IIS6 on windows server 2003.</p>

<p>And sometimes this happen to coincide with you working on an application that requires an older framework, like Sitecore 6.1 on .NET2.0</p>

<p>I was trying to run a Sitecore 6.1 site in IIS6 on a windows server 2003 that had .NET 1.1 2.0 and 4.0 installed. The application was automatically started with .NET 4.0 which doesn&#8217;t play well with Sitecore 6.1. I then tried to change the framework to .NET 2.0 which produced the following error.</p>

<blockquote>
<p>Changing the Framework version requires a restart of the W3SVC service. Alternatively, you can change the Framework version without restarting the W3SVC service by running: aspnet_regiis.exe -norestart -s IIS-Viirtual-Path</p>
</blockquote>

<p>Well, I couldn&#8217;t let it restart w3svc since a lot of other sites ran on the same server, so I tried the alternative with a few issues.</p>

<p>The first thing I noticed was that aspnet_regiis was not in my PATH so i had to find it on the filesystem (C:\WINDOWS\microsoft.net\Framework64\v2.0.50727\aspnet_regiis.exe for the 64bit version of 2.0).</p>

<p>The next issue was to find the virtualpath for my application. I found that there&#8217;s a formula to this the path should look like this: &#8220;w3svc/appID&#8221;, you can find your appID by locating your websites identifier field in the website view of the IIS manager.</p>

<p>This was of course not enough to get the application to run. I still had to create a new application pool and change the application to use this pool instead since there can only be one version of the .NET framework per pool. You can change the application pool by opening the properties for your application and looking under the &#8220;Home Directory&#8221; tab.</p>
</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Your Name<br />
                  What You Are<br />
                  your@email.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/yourusername/">github.com/yourusername</a><br />
                  <a href="http://twitter.com/yourusername/">twitter.com/yourusername</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-41772613-1', 'rosengren.me');
          ga('send', 'pageview');

        </script>
    </body>
</html>
