<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Rosengren.me - KnockoutJS and form elements</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">

        <meta property="og:type" content="article"/>
        <meta property="og:image" content="http://www.rosengren.me/assets/images/badge.jpg" />
        <meta property="og:description" content=""/>

        <!--[if lt IE 9]>
           <script>
              document.createElement('nav');
              document.createElement('header');
              document.createElement('section');
              document.createElement('footer');
              document.createElement('article');
              document.createElement('time');
           </script>
        <![endif]-->
        <link rel="stylesheet" href="/assets/styles/rosengren.css">

    </head>
    <body>
      <div class="navbar-menu-toggle" id="menu-toggle">Menu</div>
      <div class="page" id="page">
        <nav class="navbar" id="navbar-menu">
          <div class="navbar-menu collapse">
            <a class="navbar-menu-item navbar-menu-title navbar-menu-item--home" href="/">home</a>
            <a class="navbar-menu-item navbar-menu-item--blog" href="/blog">blog</a>
          </div>
          <span class="navbar-menu navbar-menu-contact collapse">
            <a class="navbar-menu-item navbar-menu-item--linkedin" href="http://www.linkedin.com/in/srosengren" target="_blank">LinkedIn</a>
            <a class="navbar-menu-item navbar-menu-item--twitter" href="https://twitter.com/srrosengren" target="_blank">Twitter</a>
            <a class="navbar-menu-item navbar-menu-item--github" href="https://github.com/srosengren" target="_blank">Github</a>
            <a class="navbar-menu-item navbar-menu-item--mail" href="javascript:;" id="mail-link">Mail</a>
          </span>
        </nav>
        <div class="main-content" id="content">
            <article class="post">
	<header>
		<h1 class="post__title">KnockoutJS and form elements</h1>
		<div class="post__byline">
			<time datetime="2013-12-07 11:28:00 +0100">07 Dec 2013</time>
			web, knockoutjs, javascript, frontend, and stratiteq
		</div>
	</header>
	<div class="post__content"><p>One of the latest projects that i’ve been involved with at Stratiteq was a form designer web application where I was tasked with setting up the frontend architecture and building the form designer itself. I decided on using <a href="http://knockoutjs.com/">KnockoutJS</a> since i’ve built applications with it before and find it to be an extremely competent MV* framework.</p>

<p>One of the reasons for choosing Knockout is because of their great documentation which can be found <a href="http://knockoutjs.com/documentation/introduction.html">here</a>, the documentation for working with form elements is excellent and they cover things like enable, value, checked and lots of bindings for options in select elements. But us developers have a way of trying to build things that the documentation doesn’t cover explicitly and I think that’s part of the beauty of our work.</p>

<h2 id="html-select">HTML select</h2>
<p>#### Dynamically switch between multiple or not
One of the elements that the user should be able to create is a listbox, i.e., a select element with either a multiple attribute or size attribute &gt; 1, the form creator should also be able to switch between multiple or not. The issue here was that only the last item was rendered as selected when I tried to render a list that was set to allow multiple and had multiple items set as selected. Here’s the code that I had when this issue presented itself</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;select</span> <span class="na">data-bind=</span><span class="s">&quot;foreach: items,attr: { multiple: multiple}&quot;</span> <span class="na">disabled</span><span class="nt">&gt;</span>
    <span class="nt">&lt;option</span> <span class="na">data-bind=</span><span class="s">&quot;text:text,value:value,attr: {selected:selected }&quot;</span><span class="nt">&gt;&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span></code></pre></div>

<p>The reason for not using the options* values that Knockout provides is that I also needed some more specific rendering control over the options that isn’t displayed in this snippet.</p>

<p>This issue was fortunately very easy to find. Knockout renders the data-bind params from left to right, meaning that all the items with their selected attributes were written before the multiple attribute was set on the select itself. The browser interprets this as it usually would, that a new selected item will be the only selected one and any previous selected item will be rerendered as unselected. All I had to do to fix this was to move the attr bind parameter to come before the foreach param.</p>

<h4 id="issues-with-optionsvalue-and-the-value-parameter-becoming-the-string-value">Issues with optionsValue and the value parameter becoming the string value</h4>
</div>
</article>
        </div>
        <footer class="footer-content">
          Powered by <a href="http://http://jekyllrb.com/" target="_blank">Jekyll</a>, hosted on <a href="https://github.com/" target="_blank">Github</a>, compiled using <a href="http://www.ruby-lang.org/en/" target="_blank">Ruby</a> and <a href="http://http://python.org/" target="_blank">Python</a> by a <a href="http://www.microsoft.com/net" target="_blank">.NET</a> guy.
        </footer>
      </div>
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-41772613-1', 'rosengren.me');
        ga('send', 'pageview');

        document.getElementById('mail-link').href = 'mailto:' + 'sebastian' + '@' + 'rosengren' + '.me';

        document.getElementById('menu-toggle').addEventListener('click', function(){
          var navbar = document.getElementById('page');
          if(navbar.className.indexOf('drawer--open') > -1){
            navbar.className = navbar.className.replace(' drawer--open','');
          } else {
            navbar.className = navbar.className + ' drawer--open';
          }
        });

        document.getElementById('content').addEventListener('click',function(){
          var navbar = document.getElementById('page');
          if(navbar.className.indexOf('drawer--open') > -1){
            navbar.className = navbar.className.replace(' drawer--open','');
          }
        })
      </script>
    </body>
</html>
